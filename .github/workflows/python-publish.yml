name: \[TEST] Publish to PyPI

on:
    release:
        types: [created]

permissions:
    contents: read

jobs:
    deploy:
        runs-on: ubuntu-latest

        steps:
            - uses: actions/checkout@v4
            - name: Set up Python
              uses: actions/setup-python@v3
              with:
                  python-version: '3.x'
            - name: Install dependencies
              run: |
                  python -m pip install --upgrade pip build twine setuptools wheel
            - name: Build package
              run: python -m build
            - name: Publish package
              run: |
                  twine upload -r testpypi dist/* -u ${{ secrets.PYPI_USERNAME }} -p ${{ secrets.PYPI_PASSWORD }}
